## Cocos Creator How To Use

### 简介

基于 CocosCreator 3.0.0 版本创建的 **火焰** 工程

### 效果预览
![image](../../gif/202203/2022030531.gif)

### 相关链接
https://mp.weixin.qq.com/s/zH8DdL1l-mH1xSdRAXlCHg

### 教程

第一部分    

1. 新建一个粒子系统，取名 Fire1
2. 通过观察现实中的火焰，我们其实可以认为，火焰的运动轨迹是从一个点生成，然后不断向上运动的，根据这个规律，我们先对发射器模块的参数进行调整
    - 展开 发射器模块(ShapeModule) 
    - 将粒子发射器半径(Radius) 设置为0.2，默认值是1，我们不需要那么粗的发射器
    - 将 开合角度(Angle) 设置为0，默认值是25，让圆锥形的发射器变成圆柱形的发射器
3. 现在可以看到粒子是不断向上飞的，仿佛没有尽头一样，我们来调整一下主模块的参数
    - 将粒子初始速度(StartSpeed) 设置为3，默认值为5，这样可以降低粒子的速度，也可以间接控制火焰的高度
    - 将粒子生命周期(StartLifetime) 设置为0.8，默认值为5，这是粒子从生成到消失的时间，可以通过其控制火焰的高度。注意不要和 粒子系统运行时间(Duration) 
    - 将 粒子系统运行时间(Duration) 设置为1，默认值是5。火焰是不断循环的，不需要那么久的运行时间
    - 将 每秒发射的粒子数(RateOverTime) 设置为40，默认值是10.粒子太少了的话，达不到燃烧的效果
    - 将 粒子初始大小(StartSize) 选择两个常数的方式，设置为0.5-0.8，这样粒子的大小就会在0.5-0.8这个范围内随机
    > 注意:整个粒子系统运行的时间是由 粒子系统运行时间(Duration)  和 粒子生命周期(StartLifetime) 加在一起的。有兴趣的小伙伴可以看一下，如果把 loop 选项去掉，总体的运行时间是接近1。8秒的
4. 勾选 大小模块(SizeOvertimeModule)，我们来设置一下火焰粒子的大小变化。让粒子从生成到消失慢慢变小
5. 勾选 颜色模块(ColorOverLifetimeModule)，我们来设置一下火焰色颜色。选择 渐变模式(gradient)，设置为由黄到红的透明的渐变色


第二部分    

1. 首先，需要一张火焰的图片。新建材质，取名叫FireMaterial
2. 选择Material的Effect，可以看到，可供粒子系统使用的 Effect 有红框中的三种，这里我们要使用的就是builtin-particle
    - builtin-particle:提供给粒子系统的 渲染模块(Renderer) 中的  ParticleMaterial 使用，当使用cpu渲染时，必须使用此Effect，这个也是默认选项
    - builtin-particle-gpu:提供给粒子系统的 渲染模块(Renderer) 中的  ParticleMaterial 使用，当使用gpu渲染时，必须使用此Effect
    - builtin-particle-trail:提供给粒子系统的 渲染模块(Renderer) 中的  TrailMaterial 使用
3. 把图片拖到 MainTexture 上
4. 新建一个粒子系统，取名Fire2，展开 渲染模块(Renderer) ，将材质 FireMaterial 拖入到 ParticleMaterial 中
5. 想要的效果是，固定显示四个序列图中的随机一张
    - 勾选贴图动画模块(TextureAnimationModule)，通过对材质的观察，我们可以看到图片是2*2的序列图
    - 将横向贴图帧数(NumTilesX) 设置为2
    - 将纵向贴图帧数(NumTilesY) 设置为2
    - 将**一个生命周期内播放几次循环(CycleCount)**设置为1，默认值0
    - 将一个周期内动画播放的帧与时间变化曲线(FrameOverTime) 选择两个常数的方式，设置为0-3，这样初始帧就会在4个序列中随机
6. 展开发射器模块(ShapeModule) ，将 粒子发射器半径(Radius) 设置为0，因为我们希望火焰从一个点内产生，而不是一个大的范围
7. 接下来对 主模块 进行设置
    - 将粒子系统运行时间(Duration) 设置为1，默认值是5。火焰是不断循环的，不需要那么久的运行时间
    - 将粒子系统所能生成的最大粒子数量(Capacity) 设置为30，默认值是100
    - 将每秒发射的粒子数(RateOverTime) 设置为30，默认值是10.粒子数量太多太少了都达不到预期的效果
    - 将粒子生命周期(StartLifetime) 选择两个常数的方式，设置为0.3-0.4，火焰的粒子不需要运行太久
    - 将粒子初始速度(StartSpeed) 设置为0.1，默认值为5，让火焰有微微跳动的感觉
    - 将粒子初始大小(StartSize) 选择两个常数的方式，设置为0.5-0.8，这样粒子的大小就会在0.5-0.8这个范围内随机
    - 将StartRotation(StartRotation) 选择两个常数的方式，设置为(-30)-308，给粒子添加随机不同的旋转角度
    - 将粒子受重力影响的系数(GravityModifier) 设置为-1，火焰应该是向上漂浮的，所以我们给他一个向上的重力系数
    > 此时可以看到，现在有点像火焰的感觉了，不过火焰并不是向上运动的，而是在自己的坐标系内向着Y轴正方向运动的，这显然不是我们想要的效果
8. 将控制粒子坐标计算所在的坐标系(SimulationSpace) 设置为World，默认是Local，这样火焰的运动就就在使用世界坐标系了
9. 给火焰上上色，勾选 颜色模块(ColorOverLifetimeModule)，调节一个你需要的颜色
10. 通过调节不同的颜色参数，可以达到很多不同的火焰特效


第三部分 不断上升的火星    

1. 新建粒子系统，命名为Spark
2. 展开发射器模块(ShapeModule) 
    - 将粒子发射器半径(Radius) 设置为0.2，让发射器的半径和火焰的半径差不多就可以了
    - 将开合角度(Angle) 设置为0，让圆锥形的发射器变成圆柱形的发射器
3. 主模块设置
    - 将粒子系统运行时间(Duration) 设置为1，保持和火焰一致就好
    - 将粒子系统所能生成的最大粒子数量(Capacity) 设置为20，火星的数量不宜过多
    - 将每秒发射的粒子数(RateOverTime) 设置为20
    - 将粒子生命周期(StartLifetime) 选择两个常数的方式，设置为0.3-0.5，火星生成之后大概0.3-0.5秒就会消失
    - 将粒子初始大小(StartSize) 选择两个常数的方式，设置为0.08-0.12，火星的尺寸可以设置的小一点
    - 将粒子初始速度(StartSpeed) 设置为8，默认值为7，让火星能达到的最大高度稍微高过火焰就好
4. 最后一步，调节一下火星的颜色，勾选 颜色模块(ColorOverLifetimeModule)，具体颜色可根据实际情况随意调节


第四部分 忽明忽暗的火光    

1. 新建粒子系统，命名为Light
2. 展开发射器模块(ShapeModule)将 粒子发射器半径(Radius) 设置为0.01，火光和火星不同，只需要让它在很小的方位内生成就行了
3. 主模块设置
    - 将粒子系统运行时间(Duration) 设置为1。
    - 将粒子系统所能生成的最大粒子数量(Capacity) 设置为5，火光只需要很少的数量不断生成就可以了。
    - 将每秒发射的粒子数(RateOverTime) 设置为5。
    - 将粒子初始速度(StartSpeed) 设置为0，火光不需要运动，只需要在原地就好。
    - 将粒子生命周期(StartLifetime) 选择两个常数的方式，设置为0.2-0.5，让粒子最长的生命周期比最短的还要大一倍，能最大程度感觉到闪动的效果
    - 将粒子初始大小(StartSize) 选择两个常数的方式，设置为1-2，以生成不同大小的火光。
    - 将粒子初始颜色(StartColor) 设置为接近火焰的颜色。