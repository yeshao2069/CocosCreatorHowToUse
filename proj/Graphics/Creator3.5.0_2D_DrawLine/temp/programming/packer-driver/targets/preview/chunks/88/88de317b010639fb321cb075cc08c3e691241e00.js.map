{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Graphics/Creator3.5.0_2D_DrawLine/assets/DrawLine.ts"],"names":["_decorator","Component","Node","Graphics","find","UITransform","Vec3","ccclass","property","DrawLine","_touches","start","canvas","on","EventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","_graphics","getComponent","moveTo","lineTo","stroke","event","length","pos","touch","getUILocation","push","touches","MIN_POINT_DISTANCE","worldPos","node","convertToWorldSpaceAR","x","y","lastIndex","i","l","clone","subtract","onClearClick","clear"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, Vec2, Graphics, find, EventTouch, UITransform, Vec3 } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('DrawLine')\nexport class DrawLine extends Component {\n\n    _touches : Vec2[] = [];\n    _graphics !: Graphics;\n\n    start () {\n        var canvas = find('Canvas')!;\n\n        canvas.on(Node.EventType.TOUCH_START, this.onTouchStart, this);\n        canvas.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n        canvas.on(Node.EventType.TOUCH_END, this.onTouchEnd, this);\n\n        this._graphics = this.getComponent(Graphics)!;\n        this._graphics.moveTo(0, 0);\n        this._graphics.lineTo(0.1, 0);\n        this._graphics.lineTo(-0.11, 0);\n        this._graphics.stroke();\n    }\n\n    onTouchStart (event: EventTouch) {\n        this._touches.length = 0;\n        this._touches = [];\n        let pos = event!.touch!.getUILocation();\n        this._touches.push(pos);\n    }\n\n    onTouchMove (event: EventTouch) {\n        let touches = this._touches;\n        let pos = event!.touch!.getUILocation();\n        touches.push(pos);\n\n        const MIN_POINT_DISTANCE = 2;\n        \n        let worldPos = this.node.getComponent(UITransform)!.convertToWorldSpaceAR(new Vec3());\n        this._graphics.moveTo(touches[0].x - worldPos.x, touches[0].y - worldPos.y);\n        let lastIndex = 0;\n        for (let i = 1, l = touches.length; i < l; i++) {\n            if (touches[i].clone().subtract(touches[lastIndex]).length() < MIN_POINT_DISTANCE) {\n                continue;\n            }\n            lastIndex = i;\n            this._graphics.lineTo(touches[i].x - worldPos.x, touches[i].y - worldPos.y);\n        }\n        this._graphics.stroke();\n    }\n\n    onTouchEnd (event: EventTouch) {\n    }\n\n    onClearClick () {\n        this._graphics.clear();\n    }\n}\n\n"]}