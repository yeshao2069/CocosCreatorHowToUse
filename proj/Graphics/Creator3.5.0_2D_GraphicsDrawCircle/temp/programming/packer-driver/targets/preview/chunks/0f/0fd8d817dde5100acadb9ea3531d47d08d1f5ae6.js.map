{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Graphics/Creator3.5.0_2D_GraphicsDrawCircle/assets/GraphicsFindAndDraw.ts"],"names":["_decorator","Component","Node","Vec3","Graphics","view","Label","ccclass","property","GraphicsFindAndDraw","tempPosVec3","start","aNode","on","EventType","TOUCH_MOVE","onClickMove","bNode","cNode","getChildByName","getComponent","string","position","x","toFixed","y","evt","localPos","getUILocation","viewRect","getVisibleSize","set","width","height","target","setPosition","tempStr","findCircle","p1","p2","p3","pt1","pt2","center","k1","k2","radius","Math","sqrt","onClickDraw","info","g","lineWidth","strokeColor","fromHEX","circle","stroke","onClickClear","clear"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, Vec3, Graphics, EventTouch, view, Label } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('GraphicsFindAndDraw')\nexport class GraphicsFindAndDraw extends Component {\n    \n    @property(Node)\n    aNode !: Node;\n    @property(Node)\n    bNode !: Node;\n    @property(Node)\n    cNode !: Node;\n\n    tempPosVec3 = new Vec3();\n\n    start () {\n        this.aNode.on(Node.EventType.TOUCH_MOVE, this.onClickMove, this);\n        this.bNode.on(Node.EventType.TOUCH_MOVE, this.onClickMove, this);\n        this.cNode.on(Node.EventType.TOUCH_MOVE, this.onClickMove, this);\n\n        // 初始化\n        this.aNode.getChildByName(\"posLab\")!.getComponent(Label)!.string = \"(\"+this.aNode.position.x.toFixed(2)+\",\"+this.aNode.position.y.toFixed(2)+\")\";\n        this.bNode.getChildByName(\"posLab\")!.getComponent(Label)!.string = \"(\"+this.bNode.position.x.toFixed(2)+\",\"+this.bNode.position.y.toFixed(2)+\")\";\n        this.cNode.getChildByName(\"posLab\")!.getComponent(Label)!.string = \"(\"+this.cNode.position.x.toFixed(2)+\",\"+this.cNode.position.y.toFixed(2)+\")\";\n    }\n\n    onClickMove (evt : EventTouch) {\n        const localPos = evt.getUILocation();\n        const viewRect = view.getVisibleSize();\n        this.tempPosVec3.set(localPos.x-viewRect.width/2, localPos.y-viewRect.height/2);\n        (evt.target as Node).setPosition(this.tempPosVec3);\n        let tempStr = \"(\"+this.tempPosVec3.x.toFixed(2)+\",\"+this.tempPosVec3.y.toFixed(2)+\")\";\n        (evt.target as Node).getChildByName(\"posLab\")!.getComponent(Label)!.string = tempStr;\n    }\n\n    /**\n     * \n     * @param p1 节点A的坐标\n     * @param p2 节点B的坐标\n     * @param p3 节点C的坐标\n     * @returns {x,y,r}\n     */\n    findCircle(p1: Vec3, p2: Vec3, p3: Vec3){\n        const pt1 = new Vec3();\n        const pt2 = new Vec3();\n        const center = new Vec3();\n\n        pt1.set((p1.x+p2.x)/2, (p1.y+p2.y)/2, 0);\n        pt2.set((p1.x+p3.x)/2, (p1.y+p3.y)/2, 0);\n\n        var k1 = (p2.y == p1.y ? 1 : -(p2.x-p1.x) / (p2.y-p1.y));\n        var k2 = (p3.y == p1.y ? 1 : -(p3.x-p1.x) / (p3.y-p1.y));\n        center.set(\n            (pt2.y - pt1.y - k2* pt2.x + k1*pt1.x) / (k1 - k2),\n            pt1.y + k1*(pt2.y-pt1.y-k2*pt2.x + k2*pt1.x)/(k1-k2),\n            0);\n        var radius = Math.sqrt((center.x-p1.x)*(center.x-p1.x) + (center.y-p1.y)*(center.y-p1.y));\n        return { center: center, radius: radius}\n    }\n\n    onClickDraw (){\n        let info = this.findCircle(this.aNode.position, this.bNode.position, this.cNode.position);\n        const g = this.getComponent(Graphics)!;\n        g.lineWidth = 2;\n        g.strokeColor.fromHEX('#FFFFFF');\n        g.circle(info.center.x, info.center.y, info.radius);\n        g.stroke();\n    }\n\n    onClickClear (){\n        const g = this.getComponent(Graphics)!;\n        g.clear();\n    }\n}\n"]}