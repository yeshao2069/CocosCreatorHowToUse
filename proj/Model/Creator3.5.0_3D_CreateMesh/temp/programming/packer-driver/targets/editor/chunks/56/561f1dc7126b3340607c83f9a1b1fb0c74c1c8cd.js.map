{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Model/Creator3.5.0_3D_CreateMesh/assets/EditableGeometry/EditableCapsule.ts"],"names":["_decorator","Component","utils","primitives","ModelComponent","CCFloat","CCInteger","ccclass","property","executeInEditMode","EditableCapsule","type","step","range","slide","model","radiusTop","_radiusTop","v","rebuildModel","radiusBottom","_radiusBottom","height","_height","sides","_sides","heightSegments","_heightSegments","fillRange","_fillRange","capped","_capped","onLoad","getComponent","addComponent","capsule","arc","Math","PI","mesh","createMesh","destroy","onDestroy"],"mappings":"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","sourcesContent":["/*\r\n * @Author: wss \r\n * @Date: 2020-04-04 20:00:33 \r\n * @Last Modified by:   wss \r\n * @Last Modified time: 2020-04-04 20:00:33 \r\n */\r\nimport { _decorator, Component, Node, utils, primitives, geometry, ModelComponent, CCFloat, CCInteger } from \"cc\";\r\nconst { ccclass, property, executeInEditMode } = _decorator;\r\n\r\n@ccclass(\"EditableCapsule\")\r\n@executeInEditMode\r\nexport class EditableCapsule extends Component {\r\n\r\n    @property\r\n    private _radiusTop: number = 0.5;\r\n    public get radiusTop(): number {\r\n        return this._radiusTop;\r\n    }\r\n    @property\r\n    public set radiusTop(v: number) {\r\n        this._radiusTop = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _radiusBottom: number = 0.5;\r\n    public get radiusBottom(): number {\r\n        return this._radiusBottom;\r\n    }\r\n    @property\r\n    public set radiusBottom(v: number) {\r\n        this._radiusBottom = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _height: number = 2;\r\n    public get height(): number {\r\n        return this._height;\r\n    }\r\n    @property\r\n    public set height(v: number) {\r\n        this._height = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _sides: number = 8;\r\n    public get sides(): number {\r\n        return this._sides;\r\n    }\r\n    @property({\r\n        type: CCInteger,\r\n        step: 1,\r\n    })\r\n    public set sides(v: number) {\r\n        this._sides = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _heightSegments: number = 24;\r\n    public get heightSegments(): number {\r\n        return this._heightSegments;\r\n    }\r\n    @property({\r\n        type: CCInteger,\r\n        step: 1,\r\n    })\r\n    public set heightSegments(v: number) {\r\n        this._heightSegments = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n\r\n    @property({\r\n        type: CCFloat,\r\n    })\r\n    private _fillRange: number = 1.0;\r\n    public get fillRange(): number {\r\n        return this._fillRange;\r\n    }\r\n    @property({\r\n        type: CCFloat,\r\n        range: [0, 1.0],\r\n        slide: true,\r\n        step: 0.1,\r\n    })\r\n    public set fillRange(v: number) {\r\n        this._fillRange = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _capped: boolean = true;\r\n    public get capped(): boolean {\r\n        return this._capped;\r\n    }\r\n    @property\r\n    public set capped(v: boolean) {\r\n        this._capped = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n\r\n    private model: ModelComponent;\r\n\r\n    onLoad() {\r\n        this.model = this.getComponent(ModelComponent);\r\n        if (this.model == null) this.model = this.addComponent(ModelComponent);\r\n        this.rebuildModel();\r\n    }\r\n\r\n    private rebuildModel() {\r\n        let capsule: primitives.IGeometry = primitives.capsule(this._radiusTop, this._radiusBottom, this._height, {\r\n            sides: this._sides,\r\n            heightSegments: this._heightSegments,\r\n            capped: this._capped,\r\n            arc: this._fillRange * 2 * Math.PI,\r\n        });\r\n\r\n        let mesh = utils.createMesh(capsule);\r\n        if (this.model.mesh) this.model.mesh.destroy();\r\n        this.model.mesh = mesh;\r\n    }\r\n\r\n    onDestroy() {\r\n        if (this.model.mesh) {\r\n            this.model.mesh.destroy();\r\n            this.model.mesh = null;\r\n        }\r\n    }\r\n}\r\n"]}