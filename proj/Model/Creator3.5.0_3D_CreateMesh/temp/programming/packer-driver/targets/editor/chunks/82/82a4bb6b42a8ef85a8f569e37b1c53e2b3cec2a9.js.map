{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Model/Creator3.5.0_3D_CreateMesh/assets/EditableGeometry/EditableCylinder.ts"],"names":["_decorator","Component","utils","primitives","ModelComponent","CCFloat","CCInteger","ccclass","property","executeInEditMode","EditableCylinder","type","step","range","slide","model","radiusTop","_radiusTop","v","rebuildModel","radiusBottom","_radiusBottom","height","_height","heightSegments","_heightSegments","fillRange","_fillRange","capped","_capped","onLoad","getComponent","addComponent","capsule","cylinder","arc","Math","PI","mesh","createMesh","destroy","onDestroy"],"mappings":"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","sourcesContent":["/*\r\n * @Author: wss \r\n * @Date: 2020-04-04 20:00:42 \r\n * @Last Modified by:   wss \r\n * @Last Modified time: 2020-04-04 20:00:42 \r\n */\r\nimport { _decorator, Component, Node, utils, primitives, geometry, ModelComponent, CCFloat, CCInteger } from \"cc\";\r\nconst { ccclass, property, executeInEditMode } = _decorator;\r\n\r\n@ccclass(\"EditableCylinder\")\r\n@executeInEditMode\r\nexport class EditableCylinder extends Component {\r\n\r\n    @property\r\n    private _radiusTop: number = 1;\r\n    public get radiusTop(): number {\r\n        return this._radiusTop;\r\n    }\r\n    @property\r\n    public set radiusTop(v: number) {\r\n        this._radiusTop = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _radiusBottom: number = 1;\r\n    public get radiusBottom(): number {\r\n        return this._radiusBottom;\r\n    }\r\n    @property\r\n    public set radiusBottom(v: number) {\r\n        this._radiusBottom = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _height: number = 3;\r\n    public get height(): number {\r\n        return this._height;\r\n    }\r\n    @property\r\n    public set height(v: number) {\r\n        this._height = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _heightSegments: number = 1;\r\n    public get heightSegments(): number {\r\n        return this._heightSegments;\r\n    }\r\n    @property({\r\n        type: CCInteger,\r\n        step: 1,\r\n    })\r\n    public set heightSegments(v: number) {\r\n        this._heightSegments = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n\r\n    @property({\r\n        type: CCFloat,\r\n    })\r\n    private _fillRange: number = 1.0;\r\n    public get fillRange(): number {\r\n        return this._fillRange;\r\n    }\r\n    @property({\r\n        type: CCFloat,\r\n        range: [0, 1.0],\r\n        slide: true,\r\n        step: 0.1,\r\n    })\r\n    public set fillRange(v: number) {\r\n        this._fillRange = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _capped: boolean = true;\r\n    public get capped(): boolean {\r\n        return this._capped;\r\n    }\r\n    @property\r\n    public set capped(v: boolean) {\r\n        this._capped = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n\r\n    private model: ModelComponent;\r\n\r\n    onLoad() {\r\n        this.model = this.getComponent(ModelComponent);\r\n        if (this.model == null) this.model = this.addComponent(ModelComponent);\r\n        this.rebuildModel();\r\n    }\r\n\r\n    private rebuildModel() {\r\n        let capsule: primitives.IGeometry = primitives.cylinder(this._radiusTop, this._radiusBottom, this._height, {\r\n            heightSegments: this._heightSegments,\r\n            capped: this._capped,\r\n            arc: this._fillRange * 2 * Math.PI,\r\n        });\r\n\r\n        let mesh = utils.createMesh(capsule);\r\n        if (this.model.mesh) this.model.mesh.destroy();\r\n        this.model.mesh = mesh;\r\n    }\r\n\r\n    onDestroy() {\r\n        if (this.model.mesh) {\r\n            this.model.mesh.destroy();\r\n            this.model.mesh = null;\r\n        }\r\n    }\r\n}\r\n"]}