{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Model/Creator3.5.0_3D_CreateMesh/assets/EditableGeometry/EditableTorus.ts"],"names":["_decorator","Component","utils","primitives","ModelComponent","CCFloat","CCInteger","ccclass","property","executeInEditMode","EditableTorus","type","step","range","slide","model","radius","_radius","v","rebuildModel","tubular","_tubular","radiusSegments","_radiusSegments","tubularSegments","_tubularSegments","fillRange","_fillRange","onLoad","getComponent","addComponent","capsule","torus","radialSegments","arc","Math","PI","mesh","createMesh","destroy","onDestroy"],"mappings":"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","sourcesContent":["/*\r\n * @Author: wss \r\n * @Date: 2020-04-04 20:00:49 \r\n * @Last Modified by:   wss \r\n * @Last Modified time: 2020-04-04 20:00:49 \r\n */\r\nimport { _decorator, Component, Node, utils, primitives, geometry, ModelComponent, CCFloat, CCInteger } from \"cc\";\r\nconst { ccclass, property, executeInEditMode } = _decorator;\r\n\r\n\r\n@ccclass(\"EditableTorus\")\r\n@executeInEditMode\r\nexport class EditableTorus extends Component {\r\n    @property\r\n    private _radius: number = 0.5;\r\n    public get radius(): number {\r\n        return this._radius;\r\n    }\r\n    @property\r\n    public set radius(v: number) {\r\n        this._radius = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _tubular: number = 0.1;\r\n    public get tubular(): number {\r\n        return this._tubular;\r\n    }\r\n    @property\r\n    public set tubular(v: number) {\r\n        this._tubular = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n\r\n    @property\r\n    private _radiusSegments: number = 8;\r\n    public get radiusSegments(): number {\r\n        return this._radiusSegments;\r\n    }\r\n    @property({\r\n        type: CCInteger,\r\n        step: 1,\r\n    })\r\n    public set radiusSegments(v: number) {\r\n        this._radiusSegments = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n\r\n    @property\r\n    private _tubularSegments: number = 24;\r\n    public get tubularSegments(): number {\r\n        return this._tubularSegments;\r\n    }\r\n    @property({\r\n        type: CCInteger,\r\n        step: 1,\r\n    })\r\n    public set tubularSegments(v: number) {\r\n        this._tubularSegments = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n\r\n    @property({\r\n        type: CCFloat,\r\n    })\r\n    private _fillRange: number = 1.0;\r\n    public get fillRange(): number {\r\n        return this._fillRange;\r\n    }\r\n    @property({\r\n        type: CCFloat,\r\n        range: [0, 1.0],\r\n        slide: true,\r\n        step: 0.1,\r\n    })\r\n    public set fillRange(v: number) {\r\n        this._fillRange = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n\r\n\r\n    private model: ModelComponent;\r\n\r\n    onLoad() {\r\n        this.model = this.getComponent(ModelComponent);\r\n        if (this.model == null) this.model = this.addComponent(ModelComponent);\r\n        this.rebuildModel();\r\n    }\r\n\r\n    private rebuildModel() {\r\n        let capsule: primitives.IGeometry = primitives.torus(this._radius, this._tubular, {\r\n            radialSegments: this._radiusSegments,\r\n            tubularSegments: this._tubularSegments,\r\n            arc: this._fillRange * 2 * Math.PI,\r\n        });\r\n\r\n        let mesh = utils.createMesh(capsule);\r\n        if (this.model.mesh) this.model.mesh.destroy();\r\n        this.model.mesh = mesh;\r\n    }\r\n\r\n    onDestroy() {\r\n        if (this.model.mesh) {\r\n            this.model.mesh.destroy();\r\n            this.model.mesh = null;\r\n        }\r\n    }\r\n}\r\n"]}