{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Model/Creator3.5.0_3D_CreateMesh/assets/EditableGeometry/EditableSphere.ts"],"names":["_decorator","Component","utils","primitives","ModelComponent","CCInteger","ccclass","property","executeInEditMode","EditableSphere","type","step","model","radius","_radius","v","rebuildModel","segments","_segments","onLoad","getComponent","addComponent","capsule","sphere","mesh","createMesh","destroy","onDestroy"],"mappings":";;;;;;;;;;;;;;AAMSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,U,OAAAA,U;AAAsBC,MAAAA,c,OAAAA,c;AAAyBC,MAAAA,S,OAAAA,S;;;;;;;OACtF;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,QAAX;AAAqBC,QAAAA;AAArB,O,GAA2CR,U;;gCAIpCS,c,WAFZH,OAAO,CAAC,gBAAD,C,UAoBHC,QAAQ,CAAC;AACNG,QAAAA,IAAI,EAAEL,SADA;AAENM,QAAAA,IAAI,EAAE;AAFA,OAAD,C,gBAnBZH,iB,qBADD,MAEaC,cAFb,SAEoCR,SAFpC,CAE8C;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eA4BlCW,KA5BkC;AAAA;;AAIzB,YAANC,MAAM,GAAY;AACzB,iBAAO,KAAKC,OAAZ;AACH;;AAEgB,YAAND,MAAM,CAACE,CAAD,EAAa;AAC1B,eAAKD,OAAL,GAAeC,CAAf;AACA,eAAKC,YAAL;AACH;;AAIkB,YAARC,QAAQ,GAAW;AAC1B,iBAAO,KAAKC,SAAZ;AACH;;AAKkB,YAARD,QAAQ,CAACF,CAAD,EAAY;AAC3B,eAAKG,SAAL,GAAiBH,CAAjB;AACA,eAAKC,YAAL;AACH;;AAKDG,QAAAA,MAAM,GAAG;AACL,eAAKP,KAAL,GAAa,KAAKQ,YAAL,CAAkBhB,cAAlB,CAAb;AACA,cAAI,KAAKQ,KAAL,IAAc,IAAlB,EAAwB,KAAKA,KAAL,GAAa,KAAKS,YAAL,CAAkBjB,cAAlB,CAAb;AACxB,eAAKY,YAAL;AACH;;AAEOA,QAAAA,YAAY,GAAG;AACnB,cAAIM,OAA6B,GAAGnB,UAAU,CAACoB,MAAX,CAAkB,KAAKT,OAAvB,EAA+B;AAC/DG,YAAAA,QAAQ,EAAC,KAAKC;AADiD,WAA/B,CAApC;AAIA,cAAIM,IAAI,GAAGtB,KAAK,CAACuB,UAAN,CAAiBH,OAAjB,CAAX;AACA,cAAI,KAAKV,KAAL,CAAWY,IAAf,EAAqB,KAAKZ,KAAL,CAAWY,IAAX,CAAgBE,OAAhB;AACrB,eAAKd,KAAL,CAAWY,IAAX,GAAkBA,IAAlB;AACH;;AAEDG,QAAAA,SAAS,GAAG;AACR,cAAI,KAAKf,KAAL,CAAWY,IAAf,EAAqB;AACjB,iBAAKZ,KAAL,CAAWY,IAAX,CAAgBE,OAAhB;AACA,iBAAKd,KAAL,CAAWY,IAAX,GAAkB,IAAlB;AACH;AACJ;;AAnDyC,O,0EAEzCjB,Q;;;;;iBAC0B,G;;kEAI1BA,Q,+JAMAA,Q;;;;;iBAC2B,E","sourcesContent":["/*\r\n * @Author: wss \r\n * @Date: 2020-04-04 20:00:45 \r\n * @Last Modified by:   wss \r\n * @Last Modified time: 2020-04-04 20:00:45 \r\n */\r\nimport { _decorator, Component, Node, utils, primitives, geometry, ModelComponent, CCFloat, CCInteger } from \"cc\";\r\nconst { ccclass, property, executeInEditMode } = _decorator;\r\n\r\n@ccclass(\"EditableSphere\")\r\n@executeInEditMode\r\nexport class EditableSphere extends Component {\r\n\r\n    @property\r\n    private _radius : number = 0.5;\r\n    public get radius() : number {\r\n        return this._radius;\r\n    }\r\n    @property\r\n    public set radius(v : number) {\r\n        this._radius = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    @property\r\n    private _segments: number = 24;\r\n    public get segments(): number {\r\n        return this._segments;\r\n    }\r\n    @property({\r\n        type: CCInteger,\r\n        step: 1,\r\n    })\r\n    public set segments(v: number) {\r\n        this._segments = v;\r\n        this.rebuildModel();\r\n    }\r\n\r\n    \r\n    private model: ModelComponent;\r\n\r\n    onLoad() {\r\n        this.model = this.getComponent(ModelComponent);\r\n        if (this.model == null) this.model = this.addComponent(ModelComponent);\r\n        this.rebuildModel();\r\n    }\r\n\r\n    private rebuildModel() {\r\n        let capsule: primitives.IGeometry = primitives.sphere(this._radius,{\r\n            segments:this._segments\r\n        });\r\n\r\n        let mesh = utils.createMesh(capsule);\r\n        if (this.model.mesh) this.model.mesh.destroy();\r\n        this.model.mesh = mesh;\r\n    }\r\n\r\n    onDestroy() {\r\n        if (this.model.mesh) {\r\n            this.model.mesh.destroy();\r\n            this.model.mesh = null;\r\n        }\r\n    }\r\n}\r\n"]}