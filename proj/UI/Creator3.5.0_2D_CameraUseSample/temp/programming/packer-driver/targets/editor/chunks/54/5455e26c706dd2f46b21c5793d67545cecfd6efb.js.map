{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/UI/Creator3.5.0_2D_CameraUseSample/assets/Script/CameraSample.ts"],"names":["_decorator","Component","Camera","Sprite","Node","Slider","RenderTexture","tween","UITransform","SpriteFrame","Label","ccclass","property","CameraSample","onLoad","renderTex","spCameraUITrans","sp_camera","node","getComponent","reset","width","height","spriteframe","spriteFrame","sp","originalSize","rect","offset","isRotate","rotated","borderTop","insetTop","borderLeft","insetLeft","borderBottom","insetBottom","borderRight","insetRight","camera","targetTexture","texture","node_icon","repeatForever","by","angle","start","onSliderChange","sl_scale","sl_h","sl_v","slider","zoomRatio","progress","orthoHeight","newCameraPos","getPosition","x","setPosition","y","updateSliderLabel","label","getChildByName","string","Math","round","toString"],"mappings":"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","sourcesContent":["import { _decorator, Component, Camera, Sprite, Node, Slider, RenderTexture, tween, Quat, Vec3, UITransform, SpriteFrame, Label } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('CameraSample')\nexport default class CameraSample extends Component {\n    @property(Camera)\n    camera !: Camera;\n    @property(Sprite)\n    sp_camera !: Sprite;\n    @property(Node)\n    node_icon !: Node;\n    @property(Slider)\n    sl_scale !: Slider;\n    @property(Slider)\n    sl_h !: Slider;\n    @property(Slider)\n    sl_v !: Slider;\n\n    onLoad() {\n        let renderTex = new RenderTexture();\n        let spCameraUITrans = this.sp_camera.node.getComponent(UITransform)!;\n        renderTex.reset({\n            width: spCameraUITrans.width,\n            height: spCameraUITrans.height,\n        });\n\n        let spriteframe: SpriteFrame = this.sp_camera.spriteFrame!;\n        let sp: SpriteFrame = new SpriteFrame();\n        sp.reset({\n            originalSize: spriteframe.originalSize,\n            rect: spriteframe.rect,\n            offset: spriteframe.offset,\n            isRotate: spriteframe.rotated,\n            borderTop: spriteframe.insetTop,\n            borderLeft: spriteframe.insetLeft,\n            borderBottom: spriteframe.insetBottom,\n            borderRight: spriteframe.insetRight,\n        });\n\n        this.camera.targetTexture = renderTex;\n        sp.texture = renderTex;\n        this.sp_camera.spriteFrame = sp;\n\n        // 无限旋转\n        tween(this.node_icon).repeatForever(\n            tween(this.node_icon).by(1, { angle: -90} )\n        ).start();\n\n        this.onSliderChange(this.sl_scale);\n        this.onSliderChange(this.sl_h);\n        this.onSliderChange(this.sl_v);\n    }\n\n    private onSliderChange(slider?: Slider) {\n        switch (slider) {\n            case this.sl_scale: {\n                const zoomRatio = this.sl_scale.progress * 2;\n                this.camera.orthoHeight = 320 * zoomRatio;   // 320是试验数据\n                // this.sp_camera.node.scale = new Vec3(zoomRatio, zoomRatio, 1);\n            break;\n            }\n            case this.sl_h: {\n                let newCameraPos = this.camera.node.getPosition();\n                newCameraPos.x = (this.sl_h.progress - 0.5) * this.node.getComponent(UITransform)!.width;\n                this.camera.node.setPosition(newCameraPos);\n            break;\n            }\n            case this.sl_v: {\n                let newCameraPos = this.camera.node.getPosition();\n                newCameraPos.y = (this.sl_v.progress - 0.5) * this.node.getComponent(UITransform)!.height;\n                this.camera.node.setPosition(newCameraPos);\n            break;\n            }\n        }\n    }\n\n    private updateSliderLabel (slider: Slider) {\n        let label = slider.node.getChildByName('label')!.getComponent(Label)!;\n        switch (slider) {\n            case this.sl_scale: {\n                label.string = 'Scale (' + Math.round(slider.progress * 100).toString() + \"%)\"\n            break;\n            }\n            case this.sl_h: {\n                label.string = 'x (' + Math.round(slider.progress * 100).toString() + \"%)\"\n            break;\n            }\n            case this.sl_v: {\n                label.string = 'y (' + Math.round(slider.progress * 100).toString() + \"%)\"\n            break;\n            }\n        }\n    }\n}\n"]}