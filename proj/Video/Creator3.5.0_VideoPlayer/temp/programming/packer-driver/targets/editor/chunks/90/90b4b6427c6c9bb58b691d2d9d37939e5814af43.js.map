{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Video/Creator3.5.0_VideoPlayer/assets/VideoPlayer.ts"],"names":["_decorator","Component","Node","VideoPlayer","Label","sys","log","ccclass","property","VideoPlayerCtl","start","keep_Ratio_Switch","active","isBrowser","platform","WECHAT_GAME","playVideoArea","on","EventType","TOUCH_END","videoPlayer","play","getStatus","event","PLAYING","PAUSED","STOPPED","COMPLETED","META_LOADED","CLICKED","READY_TO_PLAY","onVideoPlayerEvent","sender","statusLabel","string","isPlaying","pause","controlButtons","toggleFullscreen","browserType","BROWSER_TYPE_MOBILE_QQ","browserVersion","test","navigator","userAgent","fullScreenOnAwake","toggleVisibility","node","visibility","keepRatioSwitch","keepAspectRatio","switchOnlineVideo","remoteURL","resourceType","ResourceType","REMOTE","switchLoaclVide","LOCAL","stop","update","currentTime","toFixed","duration"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, VideoPlayer, Label, LabelComponent, sys, log,\n    } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('VideoPlayerCtl')\nexport class VideoPlayerCtl extends Component {\n   \n    @property(VideoPlayer)\n    videoPlayer !: VideoPlayer;\n    @property(Label)\n    statusLabel !: Label;\n    @property(Label)\n    currentTime !: Label;\n    @property(Label)\n    resSwitchBtnLabel !: Label;\n    @property(Node)\n    controlButtons !: Node;\n    @property(Node)\n    keep_Ratio_Switch !: Node;\n    @property(Node)\n    playVideoArea !: Node;\n    @property(Label)\n    visibility !: Label;\n\n    start () {\n        // this.controlButtons.active = false;\n        this.keep_Ratio_Switch.active = !(sys.isBrowser || sys.platform === sys.WECHAT_GAME);\n        this.playVideoArea.on(Node.EventType.TOUCH_END, () => {\n            this.videoPlayer.play();\n        });\n    }\n\n    getStatus (event: any) {\n        switch (event) {\n            case VideoPlayer.EventType.PLAYING:\n                return 'PLAYING';\n            case VideoPlayer.EventType.PAUSED:\n                return 'PAUSED';\n            case VideoPlayer.EventType.STOPPED:\n                return 'STOPPED';\n            case VideoPlayer.EventType.COMPLETED:\n                return 'COMPLETED';\n            case VideoPlayer.EventType.META_LOADED:\n                return 'META_LOADED';\n            case VideoPlayer.EventType.CLICKED:\n                return 'CLICKED';\n            case VideoPlayer.EventType.READY_TO_PLAY:\n                return 'READY_TO_PLAY';\n            default:\n                return 'NONE';\n        }\n    }\n\n    onVideoPlayerEvent (sender: any, event: any) {\n        this.statusLabel.string = 'Status: ' + this.getStatus(event);\n        if (event === VideoPlayer.EventType.CLICKED) {\n            if (this.videoPlayer.isPlaying) {\n                this.videoPlayer.pause();\n            } else {\n                this.videoPlayer.play();\n            }\n        }\n        else if (event === VideoPlayer.EventType.READY_TO_PLAY || event === VideoPlayer.EventType.META_LOADED) {\n            this.controlButtons.active = true;\n            this.playVideoArea.active = true;\n        }\n        else if (event === VideoPlayer.EventType.PLAYING) {\n            this.playVideoArea.active = false;\n        }\n    }\n\n    toggleFullscreen () {\n        if (\n            sys.isBrowser &&\n            sys.browserType === sys.BROWSER_TYPE_MOBILE_QQ &&\n            sys.browserVersion <= 7.2 &&\n            /Nexus 6/.test(navigator.userAgent)\n        ) {\n            return log('May be crash, so prohibit full screen');\n        }\n        this.videoPlayer.fullScreenOnAwake = true;\n    }\n\n    toggleVisibility (event: any) {\n        this.videoPlayer.node.active = !this.videoPlayer.node.active;\n        this.playVideoArea.active = this.videoPlayer.node.active;\n        this.visibility.string = 'Visibility: ' + this.videoPlayer.node.active;\n    }\n\n    keepRatioSwitch () {\n        this.videoPlayer.keepAspectRatio = !this.videoPlayer.keepAspectRatio;\n    }\n\n    switchOnlineVideo () {\n        this.videoPlayer.remoteURL = 'https://www.w3school.com.cn/i/movie.mp4';\n        this.videoPlayer.resourceType = VideoPlayer.ResourceType.REMOTE;\n        this.playVideoArea.active = true;\n    }\n\n    switchLoaclVide () {\n        this.videoPlayer.resourceType = VideoPlayer.ResourceType.LOCAL;\n        this.playVideoArea.active = true;\n    }\n\n    play () {\n        this.videoPlayer.play();\n        this.playVideoArea.active = false;\n    }\n\n    pause () {\n        this.videoPlayer.pause();\n    }\n\n    stop () {\n        this.videoPlayer.stop();\n    }\n\n    update () {\n        if (this.currentTime && this.videoPlayer.currentTime >= 0) {\n            this.currentTime.string = this.videoPlayer.currentTime.toFixed(2) + ' / ' + this.videoPlayer.duration.toFixed(2);\n        }\n    }\n}\n"]}