{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Demo/Creator3.5.0_ScreenToWorldPoint/assets/ScreenToWorldPoint.ts"],"names":["_decorator","Component","Node","Label","find","Vec3","Camera","UITransform","ccclass","property","ScreenToWorldPoint","_distance","start","canvas","on","EventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","evt","moveBox","getLocation","touchPos","pos","Camera3D","screenToWorld","x","y","box","position","parent","getComponent","convertToNodeSpaceAR","onDistanceChanged","slider","parseFloat","progress","toFixed","distanceLabel","string"],"mappings":";;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAwBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;;;;;;;OAC7E;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;oCAGjBU,kB,WADZF,OAAO,CAAC,oBAAD,C,UAGHC,QAAQ,CAACP,IAAD,C,UAERO,QAAQ,CAACN,KAAD,C,UAERM,QAAQ,CAACH,MAAD,C,2BAPb,MACaI,kBADb,SACwCT,SADxC,CACkD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAS9CU,SAT8C,GASlC,CATkC;AAAA;;AAW9CC,QAAAA,KAAK,GAAI;AACL,cAAIC,MAAM,GAAGT,IAAI,CAAC,QAAD,CAAjB;AACAS,UAAAA,MAAM,CAACC,EAAP,CAAUZ,IAAI,CAACa,SAAL,CAAeC,WAAzB,EAAsC,KAAKC,YAA3C,EAAyD,IAAzD;AACAJ,UAAAA,MAAM,CAACC,EAAP,CAAUZ,IAAI,CAACa,SAAL,CAAeG,UAAzB,EAAqC,KAAKC,WAA1C,EAAuD,IAAvD;AAEA,eAAKR,SAAL,GAAiB,GAAjB;AACH;;AAEDM,QAAAA,YAAY,CAACG,GAAD,EAAkB;AAC1B,eAAKC,OAAL,CAAaD,GAAG,CAACE,WAAJ,EAAb;AACH;;AAEDH,QAAAA,WAAW,CAACC,GAAD,EAAkB;AACzB,eAAKC,OAAL,CAAaD,GAAG,CAACE,WAAJ,EAAb;AACH;;AAEDD,QAAAA,OAAO,CAAEE,QAAF,EAAkB;AACrB,cAAIC,GAAG,GAAG,KAAKC,QAAL,CAAcC,aAAd,CAA4B,IAAIrB,IAAJ,CAASkB,QAAQ,CAACI,CAAlB,EAAqBJ,QAAQ,CAACK,CAA9B,EAAiC,KAAKjB,SAAtC,CAA5B,CAAV;AACA,eAAKkB,GAAL,CAASC,QAAT,GAAoB,KAAKD,GAAL,CAASE,MAAT,CAAiBC,YAAjB,CAA8BzB,WAA9B,EAA4C0B,oBAA5C,CAAiET,GAAjE,CAApB;AACH;;AAEDU,QAAAA,iBAAiB,CAACC,MAAD,EAAiB;AAC9B,eAAKxB,SAAL,GAAiByB,UAAU,CAACD,MAAM,CAACE,QAAP,CAAgBC,OAAhB,CAAwB,CAAxB,CAAD,CAA3B;AACA,eAAKC,aAAL,CAAmBC,MAAnB,GAA4B,gBAAgB,KAAK7B,SAAjD;AACH;;AAnC6C,O","sourcesContent":["\nimport { _decorator, Component, Node, Label, find, EventTouch, Vec2, Vec3, Camera, UITransform, Slider, view } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('ScreenToWorldPoint')\nexport class ScreenToWorldPoint extends Component {\n    \n    @property(Node)\n    box !: Node;\n    @property(Label)\n    distanceLabel !: Label;\n    @property(Camera)\n    Camera3D !: Camera;\n\n    _distance = 0;\n\n    start () {\n        var canvas = find('Canvas')!;\n        canvas.on(Node.EventType.TOUCH_START, this.onTouchStart, this);\n        canvas.on(Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n\n        this._distance = 0.5;\n    }\n\n    onTouchStart(evt: EventTouch) {\n        this.moveBox(evt.getLocation());\n    }\n\n    onTouchMove(evt: EventTouch) {\n        this.moveBox(evt.getLocation());\n    }\n\n    moveBox (touchPos: Vec2) {\n        let pos = this.Camera3D.screenToWorld(new Vec3(touchPos.x, touchPos.y, this._distance));\n        this.box.position = this.box.parent!.getComponent(UITransform)!.convertToNodeSpaceAR(pos);\n    }\n\n    onDistanceChanged(slider: Slider) {\n        this._distance = parseFloat(slider.progress.toFixed(2));\n        this.distanceLabel.string = 'distance : ' + this._distance;\n    }\n}\n"]}