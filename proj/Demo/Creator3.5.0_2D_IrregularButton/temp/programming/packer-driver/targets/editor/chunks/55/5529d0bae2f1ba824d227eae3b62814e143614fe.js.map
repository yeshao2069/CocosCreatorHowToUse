{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/Demo/Creator3.5.0_2D_IrregularButton/assets/IrregularButton.ts"],"names":["_decorator","Component","Node","Vec2","Color","UITransform","Vec3","Sprite","ccclass","property","IrregularButton","childWposList","start","wrapper","children","map","node","getComponent","convertToWorldSpaceAR","on","EventType","TOUCH_START","onTap","e","touchPos","getUILocation","dis_list","dis_list_sort","wpos","tmpVec2","x","y","dis","subtract","lengthSqr","push","sort","a","b","nearest_index","indexOf","forEach","color","WHITE","RED"],"mappings":";;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;AAAmBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;;;;;;;OAC5E;AAACC,QAAAA,OAAD;AAAUC,QAAAA;AAAV,O,GAAsBT,U;;yBAGPU,e,WADpBF,OAAO,CAAC,iBAAD,C,UAEHC,QAAQ,CAACP,IAAD,C,2BAFb,MACqBQ,eADrB,SAC6CT,SAD7C,CACuD;AAAA;AAAA;;AAAA;;AAAA,eAInDU,aAJmD,GAI3B,EAJ2B;AAAA;;AAMnDC,QAAAA,KAAK,GAAI;AACL,eAAKD,aAAL,GAAqB,KAAKE,OAAL,CAAaC,QAAb,CAAsBC,GAAtB,CAA2BC,IAAD,IAAgB;AAC3D,mBAAOA,IAAI,CAACC,YAAL,CAAkBZ,WAAlB,EAAgCa,qBAAhC,CAAsD,IAAIZ,IAAJ,EAAtD,CAAP;AACH,WAFoB,CAArB;AAIA,eAAKO,OAAL,CAAaM,EAAb,CAAgBjB,IAAI,CAACkB,SAAL,CAAeC,WAA/B,EAA4C,KAAKC,KAAjD,EAAwD,IAAxD;AACH;;AAEDA,QAAAA,KAAK,CAAEC,CAAF,EAAiB;AAClB,cAAIC,QAAQ,GAAGD,CAAC,CAACE,aAAF,EAAf,CADkB,CAGlB;;AACA,cAAIC,QAAkB,GAAG,EAAzB,CAJkB,CAKlB;;AACA,cAAIC,aAAa,GAAG,KAAKhB,aAAL,CAAmBI,GAAnB,CAAwBa,IAAD,IAAgB;AACvD,gBAAIC,OAAO,GAAG,IAAI1B,IAAJ,CAASyB,IAAI,CAACE,CAAd,EAAiBF,IAAI,CAACG,CAAtB,CAAd;AACA,gBAAIC,GAAG,GAAGH,OAAO,CAACI,QAAR,CAAiBT,QAAjB,EAA2BU,SAA3B,EAAV,CAFuD,CAGvD;;AACAR,YAAAA,QAAQ,CAACS,IAAT,CAAcH,GAAd;AACA,mBAAOA,GAAP;AACH,WANmB,EAMjBI,IANiB,CAMZ,CAACC,CAAD,EAAIC,CAAJ,KAAUD,CAAC,GAACC,CANA,CAApB,CANkB,CAclB;;AACA,cAAIC,aAAa,GAAGb,QAAQ,CAACc,OAAT,CAAiBb,aAAa,CAAC,CAAD,CAA9B,CAApB,CAfkB,CAkBlB;AACA;;AACA,eAAKd,OAAL,CAAaC,QAAb,CAAsB2B,OAAtB,CAA+BzB,IAAD,IAAgB;AAC1CA,YAAAA,IAAI,CAACC,YAAL,CAAkBV,MAAlB,EAA2BmC,KAA3B,GAAmCtC,KAAK,CAACuC,KAAzC;AACH,WAFD,EApBkB,CAuBlB;;AACA,eAAK9B,OAAL,CAAaC,QAAb,CAAsByB,aAAtB,EAAqCtB,YAArC,CAAkDV,MAAlD,EAA2DmC,KAA3D,GAAmEtC,KAAK,CAACwC,GAAzE;AACH;;AAvCkD,O","sourcesContent":["import { _decorator, Component, Node, Vec2, Color, EventTouch, UITransform, Vec3, Sprite } from 'cc';\nconst {ccclass, property} = _decorator;\n\n@ccclass('IrregularButton')\nexport default class IrregularButton extends Component {\n    @property(Node)\n    wrapper !: Node;\n\n    childWposList: Vec3[] = [];\n\n    start () {\n        this.childWposList = this.wrapper.children.map((node: Node) => {\n            return node.getComponent(UITransform)!.convertToWorldSpaceAR(new Vec3());\n        });\n\n        this.wrapper.on(Node.EventType.TOUCH_START, this.onTap, this);\n    }\n\n    onTap (e: EventTouch) {\n        let touchPos = e.getUILocation();\n\n        // 每个子节点与点击坐标的距离集合\n        let dis_list: number[] = [];\n        // 遍历所有子节点坐标得出与鼠标的距离然后升序排列\n        let dis_list_sort = this.childWposList.map((wpos: Vec3) => {\n            let tmpVec2 = new Vec2(wpos.x, wpos.y);\n            let dis = tmpVec2.subtract(touchPos).lengthSqr();\n            // 记录距离值\n            dis_list.push(dis);\n            return dis;\n        }).sort((a, b) => a-b);\n\n        // 获取排序最前面的索引\n        let nearest_index = dis_list.indexOf(dis_list_sort[0]);\n\n\n        // 颜色修改\n        // 先全部恢复白色\n        this.wrapper.children.forEach((node: Node) => {\n            node.getComponent(Sprite)!.color = Color.WHITE;\n        });\n        // 设置目标颜色 红色\n        this.wrapper.children[nearest_index].getComponent(Sprite)!.color = Color.RED;\n    }\n}"]}