{"version":3,"sources":["file:///Users/mu/work/gitee/cocos-creator-how-to-use/proj/DragonBones/Creator3.5.0_2D_DragonBonesReplaceSlot/assets/DragonBonesReplaceSlot.ts"],"names":["_decorator","Component","dragonBones","ccclass","property","DragonBonesReplaceSlot","ArmatureDisplay","_leftWeaponIndex","_rightDisplayIndex","_rightDisplayNames","_rightDisplayOffset","start","replaceArmatureDisplay","node","active","x","y","onClickLeft","armature","armatureDisplay","slot","getSlot","displayIndex","onClickRight","length","displayName","factory","CCFactory","getInstance","replaceSlotDisplay","getArmatureKey","offset","parent","invalidUpdate"],"mappings":";;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;;;;;;;OAC1B;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBJ,U;;wCAGjBK,sB,WADZF,OAAO,CAAC,wBAAD,C,UAGHC,QAAQ,CAACF,WAAW,CAACI,eAAb,C,UAERF,QAAQ,CAACF,WAAW,CAACI,eAAb,C,2BALb,MACaD,sBADb,SAC4CJ,SAD5C,CACsD;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAOlDM,gBAPkD,GAO/B,CAP+B;AAAA,eAQlDC,kBARkD,GAQ7B,CAR6B;AAAA,eASlDC,kBATkD,GASpB,EAToB;AAAA,eAUlDC,mBAVkD,GAUH,EAVG;AAAA;;AAYlDC,QAAAA,KAAK,GAAI;AACL,eAAKC,sBAAL,CAA6BC,IAA7B,CAAkCC,MAAlC,GAA2C,KAA3C;AACA,eAAKP,gBAAL,GAAwB,CAAxB;AACA,eAAKC,kBAAL,GAA0B,CAA1B;AACA,eAAKC,kBAAL,GAA0B,CAAC,eAAD,EAAkB,gBAAlB,CAA1B;AACA,eAAKC,mBAAL,GAA2B,CAAC;AAAEK,YAAAA,CAAC,EAAE,CAAL;AAAQC,YAAAA,CAAC,EAAE;AAAX,WAAD,EAAiB;AAAED,YAAAA,CAAC,EAAE,CAAC,EAAN;AAAUC,YAAAA,CAAC,EAAE;AAAb,WAAjB,CAA3B;AACH;;AAEDC,QAAAA,WAAW,GAAI;AACX,cAAIC,QAAQ,GAAG,KAAKC,eAAL,CAAsBD,QAAtB,EAAf;AACA,cAAIE,IAAI,GAAGF,QAAQ,CAACG,OAAT,CAAiB,eAAjB,CAAX;AACAD,UAAAA,IAAI,CAACE,YAAL,GAAoBF,IAAI,CAACE,YAAL,IAAqB,CAArB,GAAyB,CAAzB,GAA6B,CAAjD;AACH;;AAEDC,QAAAA,YAAY,GAAI;AACZ,eAAKf,kBAAL;AACA,eAAKA,kBAAL,IAA2B,KAAKC,kBAAL,CAAwBe,MAAnD;AACA,cAAIN,QAAQ,GAAG,KAAKC,eAAL,CAAsBD,QAAtB,EAAf;AACA,cAAIE,IAAI,GAAGF,QAAQ,CAACG,OAAT,CAAiB,eAAjB,CAAX;AACA,gBAAMI,WAAW,GAAG,KAAKhB,kBAAL,CAAwB,KAAKD,kBAA7B,CAApB;AACA,cAAIkB,OAAO,GAAGxB,WAAW,CAACyB,SAAZ,CAAsBC,WAAtB,EAAd;AACAF,UAAAA,OAAO,CAACG,kBAAR,CAA2B,KAAKjB,sBAAL,CAA6BkB,cAA7B,EAA3B,EAA0E,QAA1E,EAAoF,UAApF,EAAgGL,WAAhG,EAA6GL,IAA7G;AAEA,cAAIW,MAAM,GAAG,KAAKrB,mBAAL,CAAyB,KAAKF,kBAA9B,CAAb;AACAY,UAAAA,IAAI,CAACY,MAAL,CAAYD,MAAZ,CAAmBhB,CAAnB,GAAuBgB,MAAM,CAAChB,CAA9B;AACAK,UAAAA,IAAI,CAACY,MAAL,CAAYD,MAAZ,CAAmBf,CAAnB,GAAuBe,MAAM,CAACf,CAA9B;AACAE,UAAAA,QAAQ,CAACe,aAAT;AACH;;AAvCiD,O","sourcesContent":["\nimport { _decorator, Component, dragonBones } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('DragonBonesReplaceSlot')\nexport class DragonBonesReplaceSlot extends Component {\n\n    @property(dragonBones.ArmatureDisplay)\n    armatureDisplay !: dragonBones.ArmatureDisplay;\n    @property(dragonBones.ArmatureDisplay)\n    replaceArmatureDisplay !: dragonBones.ArmatureDisplay;\n\n    _leftWeaponIndex = 0;\n    _rightDisplayIndex = 0;\n    _rightDisplayNames:string[] = [];\n    _rightDisplayOffset:{x: number, y: number}[] = [];\n\n    start () {\n        this.replaceArmatureDisplay!.node.active = false;\n        this._leftWeaponIndex = 0;\n        this._rightDisplayIndex = 0;\n        this._rightDisplayNames = [\"weapon_1004_r\", \"weapon_1004d_r\"];\n        this._rightDisplayOffset = [{ x: 0, y: 0 }, { x: -60, y: 100 }];\n    }\n\n    onClickLeft () {\n        let armature = this.armatureDisplay!.armature()!;\n        let slot = armature.getSlot(\"weapon_hand_l\")!;\n        slot.displayIndex = slot.displayIndex == 0 ? 4 : 0;\n    }\n\n    onClickRight () {\n        this._rightDisplayIndex++;\n        this._rightDisplayIndex %= this._rightDisplayNames.length;\n        let armature = this.armatureDisplay!.armature()!;\n        let slot = armature.getSlot(\"weapon_hand_r\")!;\n        const displayName = this._rightDisplayNames[this._rightDisplayIndex];\n        let factory = dragonBones.CCFactory.getInstance() as any;\n        factory.replaceSlotDisplay(this.replaceArmatureDisplay!.getArmatureKey(), \"weapon\", \"weapon_r\", displayName, slot);\n\n        let offset = this._rightDisplayOffset[this._rightDisplayIndex];\n        slot.parent.offset.x = offset.x;\n        slot.parent.offset.y = offset.y;\n        armature.invalidUpdate();\n    }\n\n}\n\n"]}